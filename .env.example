# ========================================
# ByteBerry OAuth2 Service - Environment Variables
# ========================================

# ========================================
# üîß APPLICATION CONFIG (F0+)
# ========================================

# Node Environment
# Valores: development | production | test
NODE_ENV=development

# Server Port
# OAuth2 Service escucha en puerto 4000 internamente
PORT=4000

# Service Name
# Nombre del servicio para logs y monitoreo
SERVICE_NAME=ByteBerry-OAuth2

# Service URL
# URL p√∫blica del servicio OAuth2
SERVICE_URL=http://localhost:4000

# ========================================
# üìù LOGGING CONFIG (F0+)
# ========================================

# Log Level
# Valores: error | warn | info | debug | trace
LOG_LEVEL=debug

# Log Requests (registrar todas las peticiones HTTP)
LOG_REQUESTS=true


# ========================================
# üóÑÔ∏è DATABASE CONFIG (F2+)
# ========================================

# PostgreSQL Connection URL
# Formato: postgresql://user:password@host:port/database?schema=public
#
# Development (local):
DATABASE_URL=postgresql://oauth2:oauth2_password@localhost:5432/oauth2_dev?schema=public
#
# Production (Docker Compose):
# DATABASE_URL=postgresql://oauth2:${POSTGRES_PASSWORD}@oauth2-db:5432/oauth2?schema=public
#
# Test:
# DATABASE_URL=postgresql://oauth2:oauth2_password@localhost:5432/oauth2_test?schema=public

# Database Connection Pool Settings
DATABASE_POOL_MIN=2

# Maximum number of connections in the pool
DATABASE_POOL_MAX=10


# ========================================
# üîê JWT CONFIG (F1+)
# ========================================

# JWT Issuer (quien emite el token)
# Debe ser la URL del servicio OAuth2
JWT_ISSUER=https://byteberry.jrmdev.org

# JWT Audience (para qui√©n es el token)
# Puede ser una lista separada por comas
JWT_AUDIENCE=byteberry-api,byteberry-bff

# Access Token Expiration
# Tiempo de vida del token de acceso
# formato: segundos (n√∫mero)
JWT_ACCESS_TOKEN_EXPIRES_IN=900

# Refresh Token Expiration
# Tokens de refresh duran m√°s para evitar login frecuente
JWT_REFRESH_TOKEN_EXPIRES_IN=7d

# JWT Private Key (RS256)
# IMPORTANTE: En producci√≥n, usar secretos seguros o vault
# Generar con: openssl genrsa -out private.pem 2048
# Luego convertir a string de una l√≠nea: awk 'NF {sub(/\r/, ""); printf "%s\\n",$0;}' private.pem
#
# Development (ejemplo - NO USAR EN PRODUCCI√ìN):
JWT_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEA3Z3fGBvZhN...(resto de la clave)...\n-----END RSA PRIVATE KEY-----"

# JWT Public Key (RS256)
# Generar con: openssl rsa -in private.pem -pubout -out public.pem
# Luego convertir a string de una l√≠nea: awk 'NF {sub(/\r/, ""); printf "%s\\n",$0;}' public.pem
#
# Development (ejemplo - NO USAR EN PRODUCCI√ìN):
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEF...(resto de la clave)...\n-----END PUBLIC KEY-----"

# JWT Key ID
# Identificador de la llave usada para firmar los JWTs
# Usar para rotaci√≥n de llaves en el futuro
JWT_KEY_ID=byteberry-key-1


# ========================================
# üîë OAUTH2 CONFIG (F1+)
# ========================================

# OAuth2 Authorization Endpoint
# URL p√∫blica donde los clientes inician el flujo de autorizaci√≥n
OAUTH2_AUTHORIZATION_ENDPOINT=https://byteberry.jrmdev.org/auth/authorize

# OAuth2 Token Endpoint
# URL p√∫blica donde los clientes intercambian c√≥digos por tokens
OAUTH2_TOKEN_ENDPOINT=https://byteberry.jrmdev.org/auth/token

# OAuth2 JWKS Endpoint
# URL p√∫blica donde los servicios obtienen las llaves p√∫blicas para validar JWT
OAUTH2_JWKS_ENDPOINT=https://byteberry.jrmdev.org/auth/.well-known/jwks.json

# OAuth2 Logout Endpoint (F4+)
# OAUTH2_LOGOUT_ENDPOINT=https://byteberry.jrmdev.org/auth/logout

# Authorization Code Expiration
# Tiempo de vida del c√≥digo de autorizaci√≥n antes de ser intercambiado
OAUTH2_AUTH_CODE_EXPIRES_IN=10m

# PKCE Requirement
# Valores: true | false
# true = requiere PKCE para todos los clientes (recomendado)
OAUTH2_PKCE_REQUIRED=true

# PKCE Code Challenge Methods Allowed
# Valores: S256,plain | S256 (solo S256 es seguro)
OAUTH2_PKCE_METHODS=S256


# ========================================
# üîí SECURITY CONFIG (F0+)
# ========================================

# CORS Allowed Origins
# Lista separada por comas de or√≠genes permitidos
# Development:
# Production:
# CORS_ORIGINS=https://byteberry.jrmdev.org
CORS_ORIGINS=http://localhost:5173,http://localhost:4003

# ========================================
# üöÄ EXTERNAL SERVICES (F1+)
# ========================================

# BFF Service URL (para redirects y validaciones)
BFF_SERVICE_URL=http://bff-service:4002

# Frontend URL (para redirects despu√©s de login)
FRONTEND_URL=https://byteberry.jrmdev.org

# Expenses API URL (para validaciones de usuario, si necesario)
# EXPENSES_SERVICE_URL=http://expenses-service:4001

